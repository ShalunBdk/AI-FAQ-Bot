<h1 style="font-size: 32px; font-weight: bold; margin: 11px 0;">5.1 Бот не отвечает</h1>

<h2 style="font-size: 24px; font-weight: bold; margin: 12px 0;">Быстрая диагностика</h2>
<pre style="background-color: #f6f8fa; padding: 10px; border-radius: 4px; overflow: auto; margin: 16px 0;"><code style="font-family: Consolas, 'Courier New', monospace; font-size: 14px; color: #24292e; background-color: unset;"># 1. Проверить статус контейнеров
docker ps

# 2. Проверить логи на ошибки
docker logs faq-bot-web-1 --tail 100

# 3. Проверить использование ресурсов
docker stats --no-stream</code></pre>

<h2 style="font-size: 24px; font-weight: bold; margin: 12px 0;">Проблема: Контейнер не запущен</h2>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Симптомы</h3>
<ul style="padding-left: 24px; list-style-type: disc;">
    <li style="margin: 8px 0;"><code style="background-color: #f6f8fa; padding: 2px 4px; border-radius: 3px; font-family: Consolas, 'Courier New', monospace; font-size: 14px;">docker ps</code> не показывает контейнер faq-bot</li>
    <li style="margin: 8px 0;">Веб-админка недоступна</li>
</ul>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Решение</h3>
<pre style="background-color: #f6f8fa; padding: 10px; border-radius: 4px; overflow: auto; margin: 16px 0;"><code style="font-family: Consolas, 'Courier New', monospace; font-size: 14px; color: #24292e; background-color: unset;"># Проверить остановленные контейнеры
docker ps -a

# Посмотреть причину остановки
docker logs faq-bot-web-1

# Перезапустить
cd /path/to/FAQBot
docker compose -f docker-compose.dev.yml up -d</code></pre>

<h2 style="font-size: 24px; font-weight: bold; margin: 12px 0;">Проблема: Telegram бот не отвечает</h2>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Проверка 1: Токен</h3>
<pre style="background-color: #f6f8fa; padding: 10px; border-radius: 4px; overflow: auto; margin: 16px 0;"><code style="font-family: Consolas, 'Courier New', monospace; font-size: 14px; color: #24292e; background-color: unset;"># Проверить наличие токена в .env
grep TELEGRAM_TOKEN .env

# Проверить логи на ошибки авторизации
docker logs faq-bot-web-1 | grep -i "telegram\|unauthorized\|token"</code></pre>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Проверка 2: Сеть</h3>
<pre style="background-color: #f6f8fa; padding: 10px; border-radius: 4px; overflow: auto; margin: 16px 0;"><code style="font-family: Consolas, 'Courier New', monospace; font-size: 14px; color: #24292e; background-color: unset;"># Проверить доступность Telegram API из контейнера
docker exec faq-bot-web-1 curl -s https://api.telegram.org</code></pre>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Проверка 3: Бот заблокирован</h3>
<ul style="padding-left: 24px; list-style-type: disc;">
    <li style="margin: 8px 0;">Откройте чат с ботом в Telegram</li>
    <li style="margin: 8px 0;">Проверьте, не заблокировали ли вы бота</li>
    <li style="margin: 8px 0;">Нажмите /start для повторной активации</li>
</ul>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Решение: Перезапуск Telegram бота</h3>
<pre style="background-color: #f6f8fa; padding: 10px; border-radius: 4px; overflow: auto; margin: 16px 0;"><code style="font-family: Consolas, 'Courier New', monospace; font-size: 14px; color: #24292e; background-color: unset;">docker compose -f docker-compose.dev.yml restart</code></pre>

<h2 style="font-size: 24px; font-weight: bold; margin: 12px 0;">Проблема: Bitrix24 бот не отвечает</h2>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Проверка 1: Webhook URL</h3>
<ul style="padding-left: 24px; list-style-type: disc;">
    <li style="margin: 8px 0;">Убедитесь, что сервер доступен извне</li>
    <li style="margin: 8px 0;">Проверьте URL в настройках бота Bitrix24</li>
    <li style="margin: 8px 0;">URL должен быть: <code style="background-color: #f6f8fa; padding: 2px 4px; border-radius: 3px; font-family: Consolas, 'Courier New', monospace; font-size: 14px;">https://ваш-домен/webhook/bitrix24</code></li>
</ul>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Проверка 2: SSL сертификат</h3>
<ul style="padding-left: 24px; list-style-type: disc;">
    <li style="margin: 8px 0;">Bitrix24 требует HTTPS</li>
    <li style="margin: 8px 0;">Проверьте валидность сертификата</li>
</ul>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Проверка 3: BOT_ID</h3>
<pre style="background-color: #f6f8fa; padding: 10px; border-radius: 4px; overflow: auto; margin: 16px 0;"><code style="font-family: Consolas, 'Courier New', monospace; font-size: 14px; color: #24292e; background-color: unset;"># Проверить BOT_ID в .env
grep BITRIX24_BOT_ID .env

# Сравнить с ID бота в Bitrix24</code></pre>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Проверка 4: Логи webhook</h3>
<pre style="background-color: #f6f8fa; padding: 10px; border-radius: 4px; overflow: auto; margin: 16px 0;"><code style="font-family: Consolas, 'Courier New', monospace; font-size: 14px; color: #24292e; background-color: unset;">docker logs faq-bot-web-1 | grep -i "bitrix\|webhook"</code></pre>

<h2 style="font-size: 24px; font-weight: bold; margin: 12px 0;">Проблема: Бот отвечает с задержкой</h2>

<h3 style="font-size: 19px; font-weight: bold; margin: 14px 0;">Возможные причины</h3>
<table style="border-collapse: collapse; width: 100%; margin: 16px 0;">
    <thead>
        <tr style="background-color: #f6f8fa;">
            <th style="border: 1px solid #d0d7de; padding: 8px 12px; text-align: left;">Причина</th>
            <th style="border: 1px solid #d0d7de; padding: 8px 12px; text-align: left;">Диагностика</th>
            <th style="border: 1px solid #d0d7de; padding: 8px 12px; text-align: left;">Решение</th>
        </tr>
    </thead>
    <tbody>
        <tr>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Мало RAM</td>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;"><code style="background-color: #f6f8fa; padding: 2px 4px; border-radius: 3px; font-family: Consolas, 'Courier New', monospace; font-size: 14px;">docker stats</code></td>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Добавить RAM</td>
        </tr>
        <tr>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Медленный OpenRouter</td>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Время генерации в логах</td>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Сменить модель</td>
        </tr>
        <tr>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Большая БД</td>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;"><code style="background-color: #f6f8fa; padding: 2px 4px; border-radius: 3px; font-family: Consolas, 'Courier New', monospace; font-size: 14px;">ls -lh data/*.db</code></td>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Архивировать логи</td>
        </tr>
        <tr>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Первый запрос после старта</td>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Только первый запрос медленный</td>
            <td style="border: 1px solid #d0d7de; padding: 8px 12px;">Нормально, модель загружается</td>
        </tr>
    </tbody>
</table>

<h2 style="font-size: 24px; font-weight: bold; margin: 12px 0;">Проблема: Ошибка "Out of memory"</h2>
<pre style="background-color: #f6f8fa; padding: 10px; border-radius: 4px; overflow: auto; margin: 16px 0;"><code style="font-family: Consolas, 'Courier New', monospace; font-size: 14px; color: #24292e; background-color: unset;"># Проверить память
free -h

# Проверить использование Docker
docker stats --no-stream

# Перезапустить контейнеры для освобождения памяти
docker compose -f docker-compose.dev.yml restart</code></pre>

<h2 style="font-size: 24px; font-weight: bold; margin: 12px 0;">Экстренное восстановление</h2>
<pre style="background-color: #f6f8fa; padding: 10px; border-radius: 4px; overflow: auto; margin: 16px 0;"><code style="font-family: Consolas, 'Courier New', monospace; font-size: 14px; color: #24292e; background-color: unset;"># Полный перезапуск
cd /path/to/FAQBot
docker compose -f docker-compose.dev.yml down
docker compose -f docker-compose.dev.yml up -d

# Проверить статус
docker ps
docker logs faq-bot-web-1 --tail 20</code></pre>

<h2 style="font-size: 24px; font-weight: bold; margin: 12px 0;">Связанные статьи</h2>
<ul style="padding-left: 24px; list-style-type: disc;">
    <li style="margin: 8px 0;">5.4 Ошибки Docker</li>
    <li style="margin: 8px 0;">4.1 Мониторинг и логи</li>
</ul>
