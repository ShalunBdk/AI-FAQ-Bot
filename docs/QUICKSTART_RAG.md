# üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç: RAG –¥–ª—è FAQ Bot

## –ó–∞ 5 –º–∏–Ω—É—Ç

### 1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

```bash
pip install natasha openai
```

### 2. –ü–æ–ª—É—á–∏—Ç–µ OpenRouter API –∫–ª—é—á

1. –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å: [https://openrouter.ai/](https://openrouter.ai/)
2. –ü–æ–ø–æ–ª–Ω–∏—Ç–µ –±–∞–ª–∞–Ω—Å ($5 –º–∏–Ω–∏–º—É–º) –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –±–µ—Å–ø–ª–∞—Ç–Ω—É—é –º–æ–¥–µ–ª—å
3. –°–æ–∑–¥–∞–π—Ç–µ –∫–ª—é—á: [https://openrouter.ai/keys](https://openrouter.ai/keys)

### 3. –ù–∞—Å—Ç—Ä–æ–π—Ç–µ .env

```env
# –í–∫–ª—é—á–∏—Ç—å RAG
RAG_ENABLED=true

# –í—Å—Ç–∞–≤—å—Ç–µ –≤–∞—à –∫–ª—é—á
OPENROUTER_API_KEY=sk-or-v1-xxxxxxxxxxxxxxxxxxxxxxxxx

# –í—ã–±–µ—Ä–∏—Ç–µ –º–æ–¥–µ–ª—å (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è –¥–ª—è —Å—Ç–∞—Ä—Ç–∞)
OPENROUTER_MODEL=openai/gpt-4o-mini

# –ò–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è –º–æ–¥–µ–ª—å –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
# OPENROUTER_MODEL=google/gemini-2.0-flash-001
```

### 4. –ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä—É–π—Ç–µ

```bash
python scripts/test_rag_pipeline.py
```

–í—ã –¥–æ–ª–∂–Ω—ã —É–≤–∏–¥–µ—Ç—å:

```
‚úì –ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è: Email, —Ç–µ–ª–µ—Ñ–æ–Ω—ã, –∏–º–µ–Ω–∞ ‚Üí [EMAIL_1], [PHONE_1], [PER_1]
‚úì LLM –≥–µ–Ω–µ—Ä–∞—Ü–∏—è: –£—Å–ø–µ—à–Ω–æ
‚úì –î–µ–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è: –î–∞–Ω–Ω—ã–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã
```

### 5. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –±–æ—Ç–∞

**Telegram:**
```bash
python -m src.bots.bot
```

**Bitrix24:**
```bash
python -m src.bots.b24_bot
```

---

## –ß—Ç–æ –¥–∞–ª—å—à–µ?

- üìñ –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è: [`docs/RAG_GUIDE.md`](./RAG_GUIDE.md)
- ‚öôÔ∏è –¢–æ–Ω–∫–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∞: –∏–∑–º–µ–Ω–∏—Ç–µ `RAG_TEMPERATURE`, `RAG_MAX_TOKENS` –≤ `.env`
- üí∞ –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∑–∞—Ç—Ä–∞—Ç: –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `gpt-4o-mini` –∏–ª–∏ –±–µ—Å–ø–ª–∞—Ç–Ω—ã–π `gemini-2.0-flash-001`

---

## –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ –º–æ–¥–µ–ª–∏

| –ú–æ–¥–µ–ª—å | –¶–µ–Ω–∞ | –ö–∞—á–µ—Å—Ç–≤–æ | –î–ª—è —á–µ–≥–æ |
|--------|------|----------|----------|
| `google/gemini-2.0-flash-001` | **–ë–ï–°–ü–õ–ê–¢–ù–û** | ‚≠ê‚≠ê‚≠ê‚≠ê | –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| `openai/gpt-4o-mini` | $0.15/$0.60 –∑–∞ 1M | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | **–ü—Ä–æ–¥–∞–∫—à–Ω** |
| `openai/gpt-4o` | $2.50/$10.00 –∑–∞ 1M | ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê | –ü—Ä–µ–º–∏—É–º –∫–∞—á–µ—Å—Ç–≤–æ |

---

## –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?

```mermaid
graph LR
    A[–í–æ–ø—Ä–æ—Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è] --> B[–ö–∞—Å–∫–∞–¥–Ω—ã–π –ø–æ–∏—Å–∫]
    B --> C{–ù–∞–π–¥–µ–Ω –æ—Ç–≤–µ—Ç?}
    C -->|–î–∞| D[–ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è PII]
    D --> E[LLM –≥–µ–Ω–µ—Ä–∞—Ü–∏—è]
    E --> F[–î–µ–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è]
    F --> G[–û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é]
    C -->|–ù–µ—Ç| H[Fallback —Å–æ–æ–±—â–µ–Ω–∏–µ]
```

**–ü—Ä–∏–º–µ—Ä:**

```
üë§ –í–æ–ø—Ä–æ—Å: "–ö–∞–∫ —Å–≤—è–∑–∞—Ç—å—Å—è —Å –±—É—Ö–≥–∞–ª—Ç–µ—Ä–∏–µ–π?"

üîç –ü–æ–∏—Å–∫ ‚Üí –ù–∞–π–¥–µ–Ω–æ: "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è: –ú–∞—Ä–∏—è –ü–µ—Ç—Ä–æ–≤–∞, +7 495 123-45-67"

üîí –ê–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è ‚Üí "–ë—É—Ö–≥–∞–ª—Ç–µ—Ä–∏—è: [PER_1], [PHONE_1]"

ü§ñ LLM –≥–µ–Ω–µ—Ä–∞—Ü–∏—è ‚Üí "–°–≤—è–∂–∏—Ç–µ—Å—å —Å [PER_1] –ø–æ [PHONE_1]"

üîì –î–µ–∞–Ω–æ–Ω–∏–º–∏–∑–∞—Ü–∏—è ‚Üí "–°–≤—è–∂–∏—Ç–µ—Å—å —Å –ú–∞—Ä–∏–µ–π –ü–µ—Ç—Ä–æ–≤–æ–π –ø–æ +7 495 123-45-67"

‚úÖ –û—Ç–≤–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
```

---

## –û—Ç–∫–ª—é—á–µ–Ω–∏–µ RAG

–ï—Å–ª–∏ –Ω—É–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å—Å—è –∫ –æ–±—ã—á–Ω–æ–º—É –ø–æ–∏—Å–∫—É:

```env
RAG_ENABLED=false
```

---

## –ü–æ–º–æ—â—å

- ‚ùì –í–æ–ø—Ä–æ—Å—ã: —Å–º. [`docs/RAG_GUIDE.md`](./RAG_GUIDE.md) —Ä–∞–∑–¥–µ–ª FAQ
- üêõ –ü—Ä–æ–±–ª–µ–º—ã: —Ä–∞–∑–¥–µ–ª Troubleshooting –≤ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- üìù –ü—Ä–∏–º–µ—Ä—ã: [`scripts/test_rag_pipeline.py`](../scripts/test_rag_pipeline.py)
